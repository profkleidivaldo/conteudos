<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>üìö Li√ß√£o+ ¬∑ Conte√∫dos</title>
<style>
  :root{--blue:#0e7490;--light:#e6f6fb;--muted:#667085}
  body{font-family:Inter,Segoe UI,Arial,sans-serif;margin:0;background:linear-gradient(180deg,#f8fbfd,#eef9ff);color:#123}
  header{background:linear-gradient(90deg,#0ea5a4,#06b6d4);color:white;padding:20px;text-align:center}
  header h1{margin:0;font-size:22px}
  main{padding:18px;max-width:1200px;margin:0 auto}
  .ano{margin:26px 0}
  .ano h2{margin:0 0 10px 0;padding-left:10px;border-left:6px solid var(--blue);color:var(--blue)}
  .materia{margin:12px 0 22px}
  .materia h3{margin:6px 0;color:#0b5660}
  .carrossel{display:flex;gap:12px;overflow-x:auto;padding:12px 6px}
  .carrossel::-webkit-scrollbar{height:10px}
  .card{flex:0 0 200px;background:white;border-radius:10px;box-shadow:0 6px 18px rgba(10,20,30,0.06);overflow:hidden;cursor:pointer;min-height:220px;display:flex;flex-direction:column}
  .thumb{height:120px;background:#fafafa;display:flex;align-items:center;justify-content:center}
  .thumb img{width:100%;height:100%;object-fit:cover}
  .meta{padding:10px;flex:1;display:flex;flex-direction:column}
  .meta .title{font-weight:700;margin-bottom:6px;color:#0e5870;font-size:0.95rem}
  .meta .sub{flex:1;color:var(--muted);font-size:0.86rem}
  .meta .link{margin-top:8px;text-decoration:none;padding:8px 10px;border-radius:8px;background:var(--blue);color:white;display:inline-block;font-weight:700}
  .note{color:var(--muted);padding:14px;background:#fff;border-radius:10px;box-shadow:0 6px 18px rgba(10,20,30,0.04);margin-top:12px}
  footer{padding:18px;text-align:center;color:var(--muted);font-size:14px}
</style>
</head>
<body>
<header>
  <h1>üìö Li√ß√£o+ ‚Äî Cat√°logo autom√°tico</h1>
  <div style="font-size:13px;color:rgba(255,255,255,0.9);margin-top:6px">Busca por pastas e aulas HTML diretamente do reposit√≥rio GitHub</div>
</header>

<main id="main">
  <p id="status" style="text-align:center;padding:18px;color:var(--muted)">üîÑ Carregando pastas...</p>
  <div id="catalogo"></div>
</main>

<footer>¬© Li√ß√£o+ ‚Äî Plataforma baseada em GitHub Pages</footer>

<script>
const usuario = "profkleidivaldo";
const repositorio = "conteudos";
let raizApi = "";

async function descobrirBranch(){
  const res = await fetch(`https://api.github.com/repos/${usuario}/${repositorio}`);
  const repo = await res.json();
  return repo.default_branch || "main";
}

async function listarDiretorio(apiUrl){
  try{
    const res = await fetch(apiUrl);
    if(!res.ok) return [];
    const dados = await res.json();
    return Array.isArray(dados)?dados:[];
  }catch(e){ console.error(e); return []; }
}

function safeText(s){
  return decodeURIComponent(s).replace(/\.html?$/i,'').replace(/[-_]/g,' ');
}

function formatTitle(nome){
  let t = nome.replace(/_/g,' ').replace(/-/g,' ');
  t = t.replace(/^(\d)ano$/i, (m,g1)=>`${g1}¬∫ Ano`);
  t = t.replace(/linguaportuguesa/i, 'L√≠ngua Portuguesa');
  t = t.replace(/matematica/i, 'Matem√°tica');
  t = t.replace(/historia/i, 'Hist√≥ria');
  t = t.replace(/geografia/i, 'Geografia');
  t = t.replace(/ciencias/i, 'Ci√™ncias');
  return t.charAt(0).toUpperCase() + t.slice(1);
}

function ghPagesUrl(parts){
  const encoded = parts.map(p => encodeURIComponent(p));
  return `https://${usuario}.github.io/${repositorio}/${encoded.join('/')}`;
}

function criarCard(title, url, topico){
  const div = document.createElement("a");
  div.className = "card";
  div.href = url;
  div.target = "_blank";
  div.innerHTML = `
    <div class="thumb"><img src="https://picsum.photos/400/240?random=${Math.floor(Math.random()*100)}" alt=""></div>
    <div class="meta">
      <div class="title">${title}</div>
      <div class="sub">${formatTitle(topico||"Aula")}</div>
      <a class="link" href="${url}" target="_blank">Abrir</a>
    </div>`;
  return div;
}

async function montarCatalogo(){
  const status = document.getElementById("status");
  const catalogo = document.getElementById("catalogo");
  status.textContent = "üîç Buscando pastas...";
  catalogo.innerHTML = "";

  const branch = await descobrirBranch();
  raizApi = `https://api.github.com/repos/${usuario}/${repositorio}/contents?ref=${branch}`;
  const raiz = await listarDiretorio(raizApi);
  const anos = raiz.filter(x=>x.type==="dir" && /^\d.*ano$/i.test(x.name));

  if(!anos.length){ status.textContent = "‚ö†Ô∏è Nenhuma pasta de ano encontrada."; return; }
  status.textContent = "";

  for(const ano of anos){
    const anoDiv = document.createElement("div");
    anoDiv.className = "ano";
    anoDiv.innerHTML = `<h2>${formatTitle(ano.name)}</h2>`;
    catalogo.appendChild(anoDiv);

    const materias = (await listarDiretorio(ano.url)).filter(x=>x.type==="dir");
    for(const materia of materias){
      const matDiv = document.createElement("div");
      matDiv.className = "materia";
      matDiv.innerHTML = `<h3>${formatTitle(materia.name)}</h3>`;
      anoDiv.appendChild(matDiv);

      const carrossel = document.createElement("div");
      carrossel.className = "carrossel";
      matDiv.appendChild(carrossel);

      const topicos = (await listarDiretorio(materia.url)).filter(x=>x.type==="dir");
      for(const topico of topicos){
        const arquivos = (await listarDiretorio(topico.url)).filter(f=>f.name.endsWith(".html"));
        for(const arq of arquivos){
          const card = criarCard(safeText(arq.name), ghPagesUrl([ano.name,materia.name,topico.name,arq.name]), topico.name);
          carrossel.appendChild(card);
        }
      }
    }
  }
}

montarCatalogo();
</script>
</body>
</html>
